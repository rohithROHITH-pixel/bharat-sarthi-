rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Helper function to check if the user is an admin via custom claims.
    function isAdmin() {
      return request.auth != null && request.auth.token.admin == true;
    }

    // Rules for the 'news' collection
    match /news/{newsId} {
      // Anyone can read news articles.
      allow read: if true;

      // Only admins can create, update, or delete articles.
      // We also check that the creatorId matches the user's UID on create.
      allow create: if isAdmin() && request.resource.data.creatorId == request.auth.uid;
      allow update, delete: if isAdmin();
    }
    
    // Rules for the 'newspapers' collection
    match /newspapers/{newspaperId} {
        // Anyone can read (download) newspapers.
        allow read: if true;
        
        // Only admins can upload (create) and delete newspapers.
        // We also check that the creatorId matches the user's UID on create.
        allow create: if isAdmin() && request.resource.data.creatorId == request.auth.uid;
        allow delete: if isAdmin();
    }
  }
}

    